# API V6

* [Item API V6](#item-api-v6)
  * [Processing](#processing)
    * [Request](#item-processing-request)
      * [Request Body](#item-processing-request-body)
    * [Response](#item-processing-response)
      * [Response body](#item-processing-response-body)
      * [Example body response](#item-processing-example-body-response)
    * [Errors](#item-processing-errors)
      * [Example error response](#item-processing-example-error-response)

# Item API V6

## Processing

Endpoint to cancel or send items to reprocess in an optimistic way, i.e.
In case the item doesn't exist or if it's not in processing state,
no error will be responded.
### Item Processing Request

URL: `/api/v6/items/processing`

METHOD: `PUT`

HEADERS:
```http request
Authorization: Bearer {{ jwt-token }}
Content-Type: application/json
```

BODY:
#### Item Processing Request Body
```
[].id - String/Id - The item id.

[].action - Enum[String] - The action to be performed. Accepts: cancel and reprocess
```

#### Item Processing Example body request

```json
[
  {
    "id": "5ce1f6a0540dc876fa157143",
    "action": "cancel"
  },
  {
    "id": "5f7e0d30621b6fdc574444e5",
    "action": "reprocess"
  }
]
```

#### Item Processing Example call

```shell script
curl -v -X PUT -H 'User-Agent: Faraday v0.9.0' -H 'Authorization: Bearer some-valid-jwt-token' -H 'Content-Type: application/json' -d '[{ "id": "5ce1f6a0540dc876fa157143", "action": "cancel" }, { "id": "5f7e0d30621b6fdc574444e5", "action": "reprocess" }]' "https://api-staging.neat.com/api/v6/items/processing"
```

### Item Processing Response

`200 - Ok`

#### Item Processing Response body

A v6 json representation of the latest state
of the items that was sent to reprocess.

#### Item Processing Example body response

```json
{
  "items": [
    {
      "id": "5ce1f6a0540dc876fa157143",
      "account_id": "568e8f793cc40e3a370005bf",
      "name": "The Pizza Press",
      "description": "May 19, 2019; $27.91; AmericanExpress; Meals/Restaurants",
      "type": "receipt",
      "created_at": "2019-05-20T00:36:48Z",
      "updated_at": "2020-05-19T21:52:27Z",
      "file_source": "Mobile",
      "parent": {
        "id": "568e941e61b6a6fc7000000f",
        "name": "Unfiled"
      },
      "attributes": {
        "tax_category": -2367,
        "vendor": "The Pizza Press",
        "receipt_date": "2019-05-19T00:00:00Z",
        "payment_type": "AmericanExpress",
        "expense_category": "Meals/Restaurants",
        "total_amount": 27.91,
        "sales_tax": 1.71,
        "currency_type": "USD",
        "name": "The Pizza Press",
        "description": "May 19, 2019; $27.91; AmericanExpress; Meals/Restaurants",
        "amount": 27.91,
        "category": "Meals/Restaurants",
        "date": "2019-05-19T00:00:00Z"
      },
      "page_count": 1,
      "total_page_count": 1,
      "share_type": 0,
      "transaction_id": null,
      "needs_review": true,
      "activation_services_sent": {},
      "state": "processing",
      "trashed": false,
      "comments": [
        {
          "user_name": "User name",
          "message": "xxxxxxx",
          "created_at": "2020-10-07T19:38:19Z"
        }
      ]
    }
  ]
}
```

### Item Processing Errors

`400:`

  * Token is invalid.

`401:`

  * Unauthorized.

#### Item Processing Example error response

```json
{
  "error": {
    "message": "Token is invalid.",
    "code": 400
  }
}
```
